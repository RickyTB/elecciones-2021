{"version":3,"sources":["enums/heatmap-type.ts","enums/table.ts","components/Map/Map.tsx","components/ColorBox/ColorBox.tsx","components/ColorGuide/ColorGuide.tsx","components/Toolbar/Toolbar.tsx","heatmaps/heatmap.ts","heatmaps/poverty.ts","data/elecciones_provincia.csv","data/elecciones_circunscripcion.csv","data/elecciones_canton.csv","data/elecciones_parroquia.csv","data/elecciones_zona.csv","data/elecciones_junta.csv","data/elecciones_res_presidente.csv","data/pobreza_cantones.csv","data/pobreza_parroquias.csv","bin/db.ts","components/Layout/Layout.tsx","theme/styles.ts","containers/App/App.tsx","theme/colors.ts","theme/fonts.ts","reportWebVitals.ts","index.tsx","data/tables.sql"],"names":["HeatMapType","Table","MapEvents","onZoomChange","map","useMapEvents","zoom","event","getZoom","defaultStyle","fillOpacity","fillColor","color","weight","opacity","Map","heatMap","useState","setZoom","MapContainer","center","style","height","zoomControl","GeoJSON","data","cantonesData","onEachFeature","processCantones","provinciasData","processProvincias","ColorBox","title","subtitle","bg","flex","p","as","size","ColorGuide","position","bottom","left","right","zIndex","boxShadow","overflow","flexDir","justifyContent","alignItems","minW","width","props","index","key","titles","Poverty","Toolbar","heatMapType","onHeatMapChange","useColorModeValue","justify","top","Button","rightIcon","ChevronDown","Object","keys","onClick","HeatMap","printSubtitle","value","PovertyHeatMap","feature","layer","id","properties","id_prov","pobParroquias","alasql","pobCantones","pobrezaList","pobreza","paintFeature","dpa_despro","ID","DPA_DESCAN","poverty","findPoverty","reduce","obj","Math","floor","0","1","2","3","4","5","6","7","8","9","name","bindTooltip","toFixed","options","this","table","Provincia","path","provinciaCsv","Circunscripcion","circunscripcionCsv","Canton","cantonCsv","Parroquia","parroquiaCsv","Zona","zonaCsv","Junta","juntaCsv","ResPresidente","resultadosCsv","PobCantones","pobCantonesCsv","PobParroquias","pobParroquiasCsv","parseData","a","Promise","res","error","Papa","download","header","dynamicTyping","complete","results","tablesSQL","tables","foreignKeys","filter","endsWith","foreignKey","Layout","setHeatMap","heatMapMap","setHeatMapMap","useEffect","initDb","then","styles","global","body","mode","theme","extendTheme","colors","brand","50","100","200","300","400","500","600","700","800","900","fonts","heading","mono","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.b0c1b8f3.chunk.js","sourcesContent":["export enum HeatMapType {\r\n  Poverty = \"poverty\",\r\n}\r\n","export enum Table {\r\n  Provincia = \"provincia\",\r\n  Circunscripcion = \"circunscripcion\",\r\n  Canton = \"canton\",\r\n  Parroquia = \"parroquia\",\r\n  Zona = \"zona\",\r\n  Junta = \"junta\",\r\n  ResPresidente = \"res_presidente\",\r\n  PobCantones = \"pob_cantones\",\r\n  PobParroquias = \"pob_parroquias\",\r\n}\r\n","import { MapContainer, GeoJSON, useMapEvents } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport * as cantonesData from \"../../data/ecuador_cantones.json\";\r\nimport * as provinciasData from \"../../data/ecuador_provincias.json\";\r\nimport { useState } from \"react\";\r\nimport \"./Map.css\";\r\nimport { HeatMap } from \"../../heatmaps\";\r\n\r\nexport interface MapProps {\r\n  heatMap: HeatMap;\r\n}\r\n\r\ninterface MapEventsProps {\r\n  onZoomChange: (zoom: number) => void;\r\n}\r\n\r\nconst MapEvents: React.FC<MapEventsProps> = ({ onZoomChange }) => {\r\n  const map = useMapEvents({\r\n    zoom(event) {\r\n      onZoomChange(map.getZoom());\r\n    },\r\n  });\r\n  return null;\r\n};\r\n\r\nconst defaultStyle = {\r\n  fillOpacity: 1,\r\n  fillColor: \"#fff\",\r\n  color: \"black\",\r\n  weight: 2,\r\n  opacity: 0.6\r\n};\r\n\r\n//(layer as any).options.fillOpacity = 1;\r\n\r\nconst Map: React.FC<MapProps> = ({ heatMap }) => {\r\n  const [zoom, setZoom] = useState(6);\r\n  return (\r\n    <MapContainer\r\n      center={[-2.778, -83.54]}\r\n      zoom={zoom}\r\n      style={{ height: \"100vh\" }}\r\n      zoomControl={false}\r\n    >\r\n      {zoom > 8 ? (\r\n        <GeoJSON\r\n          data={cantonesData.features as any}\r\n          key=\"cantones\"\r\n          onEachFeature={heatMap.processCantones}\r\n          style={defaultStyle}\r\n        />\r\n      ) : (\r\n        <GeoJSON\r\n          data={provinciasData.features as any}\r\n          key=\"provincias\"\r\n          onEachFeature={heatMap.processProvincias}\r\n          style={defaultStyle}\r\n        />\r\n      )}\r\n      <MapEvents onZoomChange={setZoom} />\r\n    </MapContainer>\r\n  );\r\n};\r\n\r\nexport default Map;\r\n","import { Box, Heading, Text } from \"@chakra-ui/react\";\r\n\r\nexport interface ColorBoxProps {\r\n  title: string;\r\n  subtitle: string;\r\n  bg: string;\r\n  color: string;\r\n}\r\n\r\nconst ColorBox: React.FC<ColorBoxProps> = ({ title, subtitle, bg, color }) => {\r\n  return (\r\n    <Box bg={bg} color={color} flex=\"1\" p={3}>\r\n      <Heading as=\"h3\" size=\"md\">\r\n        {title}\r\n      </Heading>\r\n      <Text>{subtitle}</Text>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default ColorBox;\r\n","import { Box, Flex } from \"@chakra-ui/react\";\r\nimport { ColorBox } from \"../ColorBox\";\r\nimport { HeatMap } from \"../../heatmaps\";\r\nimport React from \"react\";\r\n\r\nexport interface ColorGuideProps {\r\n  heatMap: HeatMap;\r\n}\r\n\r\nconst ColorGuide: React.FC<ColorGuideProps> = ({ heatMap }) => (\r\n  <Box\r\n    position=\"absolute\"\r\n    bottom={0}\r\n    left={0}\r\n    right={0}\r\n    zIndex=\"banner\"\r\n    boxShadow=\"base\"\r\n    overflow=\"auto\"\r\n  >\r\n    <Flex\r\n      flexDir=\"row\"\r\n      justifyContent=\"space-evenly\"\r\n      alignItems=\"stretch\"\r\n      minW=\"1080px\"\r\n      width=\"100%\"\r\n    >\r\n      {heatMap.props.map((props, index) => (\r\n        <ColorBox {...props} key={index} />\r\n      ))}\r\n    </Flex>\r\n  </Box>\r\n);\r\n\r\nexport default ColorGuide;\r\n","import { ChevronDownIcon } from \"@chakra-ui/icons\";\r\nimport {\r\n  Box,\r\n  Button,\r\n  Flex,\r\n  Heading,\r\n  Menu,\r\n  MenuButton,\r\n  MenuItem,\r\n  MenuList,\r\n  useColorModeValue,\r\n} from \"@chakra-ui/react\";\r\nimport React from \"react\";\r\nimport { HeatMapType } from \"../../enums\";\r\n\r\nexport interface ToolbarProps {\r\n  className?: string;\r\n  heatMapType: HeatMapType;\r\n  onHeatMapChange: (type: HeatMapType) => void;\r\n}\r\n\r\nconst titles: Record<HeatMapType, string> = {\r\n  [HeatMapType.Poverty]: \"Pobreza\",\r\n};\r\n\r\nconst Toolbar: React.FC<ToolbarProps> = ({ heatMapType, onHeatMapChange }) => {\r\n  const bg = useColorModeValue(\"brand.600\", \"brand.300\");\r\n  const color = useColorModeValue(\"white\", \"gray.800\");\r\n  return (\r\n    <Flex\r\n      as=\"nav\"\r\n      p={2}\r\n      justify=\"space-between\"\r\n      bg={bg}\r\n      position=\"fixed\"\r\n      top=\"0\"\r\n      left=\"0\"\r\n      right=\"0\"\r\n      boxShadow=\"sm\"\r\n      zIndex=\"sticky\"\r\n    >\r\n      <Box p=\"2\">\r\n        <Heading size=\"md\" color={color}>\r\n          Elecciones 2021\r\n        </Heading>\r\n      </Box>\r\n      <Box>\r\n        <Menu>\r\n          <MenuButton as={Button} rightIcon={<ChevronDownIcon />}>\r\n            {titles[heatMapType]}\r\n          </MenuButton>\r\n          <MenuList>\r\n            {(Object.keys(titles) as HeatMapType[]).map((key) => (\r\n              <MenuItem key={key} onClick={() => onHeatMapChange(key)}>\r\n                {titles[key]}\r\n              </MenuItem>\r\n            ))}\r\n          </MenuList>\r\n        </Menu>\r\n      </Box>\r\n    </Flex>\r\n  );\r\n};\r\n\r\nexport default Toolbar;\r\n","import * as geojson from \"geojson\";\r\nimport { Layer } from \"leaflet\";\r\nimport { ColorBoxProps } from \"../components/ColorBox/ColorBox\";\r\n\r\nexport abstract class HeatMap {\r\n  abstract readonly props: ColorBoxProps[];\r\n\r\n  abstract processProvincias: (\r\n    feature: geojson.Feature<geojson.GeometryObject>,\r\n    layer: Layer\r\n  ) => void;\r\n\r\n  abstract processCantones: (\r\n    feature: geojson.Feature<geojson.GeometryObject>,\r\n    layer: Layer\r\n  ) => void;\r\n}\r\n","import alasql from \"alasql\";\r\nimport { Feature, Geometry, GeoJsonProperties } from \"geojson\";\r\nimport { Layer } from \"leaflet\";\r\nimport { ColorBoxProps } from \"../components/ColorBox/ColorBox\";\r\nimport { HeatMap } from \"./heatmap\";\r\n\r\nconst printSubtitle = (value: number) =>\r\n  `${value} provincia${value === 1 ? \"\" : \"s\"}`;\r\n\r\nexport class PovertyHeatMap extends HeatMap {\r\n  readonly props: ColorBoxProps[];\r\n\r\n  constructor() {\r\n    super();\r\n    const poverty = this.findPoverty();\r\n    this.props = [\r\n      {\r\n        title: \"0% - 10%\",\r\n        bg: \"#ffe2f1\",\r\n        color: \"black\",\r\n        subtitle: printSubtitle(poverty[0]),\r\n      },\r\n      {\r\n        title: \"10% - 20%\",\r\n        bg: \"#ffb3cf\",\r\n        color: \"black\",\r\n        subtitle: printSubtitle(poverty[1]),\r\n      },\r\n      {\r\n        title: \"20% - 30%\",\r\n        bg: \"#fc83ab\",\r\n        color: \"black\",\r\n        subtitle: printSubtitle(poverty[2]),\r\n      },\r\n      {\r\n        title: \"30% - 40%\",\r\n        bg: \"#f95283\",\r\n        color: \"black\",\r\n        subtitle: printSubtitle(poverty[3]),\r\n      },\r\n      {\r\n        title: \"40% - 50%\",\r\n        bg: \"#f62259\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[4]),\r\n      },\r\n      {\r\n        title: \"50% - 60%\",\r\n        bg: \"#dd0939\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[5]),\r\n      },\r\n      {\r\n        title: \"60% - 70%\",\r\n        bg: \"#ad0337\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[6]),\r\n      },\r\n      {\r\n        title: \"70% - 80%\",\r\n        bg: \"#7c002f\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[7]),\r\n      },\r\n      {\r\n        title: \"80% - 90%\",\r\n        bg: \"#4d0021\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[8]),\r\n      },\r\n      {\r\n        title: \"90% - 100%\",\r\n        bg: \"#20000d\",\r\n        color: \"white\",\r\n        subtitle: printSubtitle(poverty[9]),\r\n      },\r\n    ];\r\n  }\r\n\r\n  findPoverty() {\r\n    const pobParroquias = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, provinciaId\r\n      FROM provincia \r\n        JOIN canton ON canton.provinciaId = provincia.id\r\n        JOIN parroquia ON parroquia.cantonId = canton.id\r\n        JOIN pob_parroquias ON pob_parroquias.parroquiaId = parroquia.id\r\n      GROUP BY provinciaId;\r\n    `\r\n    );\r\n\r\n    const pobCantones = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, provinciaId\r\n      FROM provincia \r\n        JOIN canton ON canton.provinciaId = provincia.id\r\n        JOIN pob_cantones ON pob_cantones.cantonId = canton.id\r\n      GROUP BY provinciaId;\r\n    `\r\n    );\r\n\r\n    const pobrezaList = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, provinciaId\r\n      FROM ?\r\n      GROUP BY provinciaId;\r\n    `,\r\n      [[...pobParroquias, ...pobCantones]]\r\n    );\r\n\r\n    const resultado = alasql(\r\n      `\r\n      SELECT (pobres / total) pobreza FROM (\r\n        SELECT SUM(pobres) pobres, SUM(total) total\r\n        FROM ?\r\n        GROUP BY provinciaId\r\n      );\r\n    `,\r\n      [pobrezaList]\r\n    ) as any[];\r\n\r\n    return resultado.reduce(\r\n      (obj, { pobreza }) => {\r\n        obj[Math.floor(pobreza * 10)] += 1;\r\n        return obj;\r\n      },\r\n      {\r\n        0: 0,\r\n        1: 0,\r\n        2: 0,\r\n        3: 0,\r\n        4: 0,\r\n        5: 0,\r\n        6: 0,\r\n        7: 0,\r\n        8: 0,\r\n        9: 0,\r\n      }\r\n    );\r\n  }\r\n\r\n  paintFeature(layer: Layer, name: string, poverty: number) {\r\n    layer.bindTooltip(`\r\n      <h4><strong>${name}</strong></h4>\r\n      <span>${(poverty * 100).toFixed(2)}%</span>\r\n    `);\r\n\r\n    (layer as any).options.fillColor = this.props[Math.floor(poverty * 10)].bg;\r\n  }\r\n\r\n  processProvincias = (\r\n    feature: Feature<Geometry, GeoJsonProperties>,\r\n    layer: Layer\r\n  ): void => {\r\n    const id = feature.properties?.id_prov;\r\n    if (id === 25) return;\r\n\r\n    const pobParroquias = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, provinciaId\r\n      FROM provincia \r\n        JOIN canton ON canton.provinciaId = provincia.id\r\n        JOIN parroquia ON parroquia.cantonId = canton.id\r\n        JOIN pob_parroquias ON pob_parroquias.parroquiaId = parroquia.id\r\n      WHERE provincia.id = ${id}\r\n      GROUP BY provinciaId;\r\n    `\r\n    );\r\n\r\n    const pobCantones = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, provinciaId\r\n      FROM provincia \r\n        JOIN canton ON canton.provinciaId = provincia.id\r\n        JOIN pob_cantones ON pob_cantones.cantonId = canton.id\r\n      WHERE provincia.id = ${id}\r\n      GROUP BY provinciaId;\r\n    `\r\n    );\r\n\r\n    const pobrezaList = [...pobParroquias, ...pobCantones];\r\n    const [{ pobreza }] = alasql(\r\n      `\r\n      SELECT (pobres / total) pobreza FROM (\r\n        SELECT SUM(pobres) pobres, SUM(total) total\r\n        FROM ?\r\n      );\r\n    `,\r\n      [pobrezaList]\r\n    );\r\n\r\n    this.paintFeature(layer, feature.properties?.dpa_despro, pobreza);\r\n  };\r\n\r\n  processCantones = (\r\n    feature: Feature<Geometry, GeoJsonProperties>,\r\n    layer: Layer\r\n  ): void => {\r\n    const id = feature.properties?.ID;\r\n\r\n    const pobParroquias = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, cantonId\r\n      FROM canton \r\n        JOIN parroquia ON parroquia.cantonId = canton.id\r\n        JOIN pob_parroquias ON pob_parroquias.parroquiaId = parroquia.id\r\n      WHERE canton.id = ${id}\r\n      GROUP BY cantonId;\r\n    `\r\n    );\r\n\r\n    const pobCantones = alasql(\r\n      `\r\n      SELECT SUM(pobres) pobres, SUM(total) total, cantonId\r\n      FROM canton\r\n        JOIN pob_cantones ON pob_cantones.cantonId = canton.id\r\n      WHERE canton.id = ${id}\r\n      GROUP BY cantonId;\r\n    `\r\n    );\r\n\r\n    const pobrezaList = [...pobParroquias, ...pobCantones];\r\n    const [{ pobreza }] = alasql(\r\n      `\r\n      SELECT (pobres / total) pobreza FROM (\r\n        SELECT SUM(pobres) pobres, SUM(total) total\r\n        FROM ?\r\n      );\r\n    `,\r\n      [pobrezaList]\r\n    );\r\n\r\n    this.paintFeature(layer, feature.properties?.DPA_DESCAN, pobreza);\r\n  };\r\n}\r\n","export default __webpack_public_path__ + \"static/media/elecciones_provincia.b1b18fef.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_circunscripcion.c6258590.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_canton.c922d201.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_parroquia.70665e28.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_zona.208935dd.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_junta.a0565549.csv\";","export default __webpack_public_path__ + \"static/media/elecciones_res_presidente.30a777ff.csv\";","export default __webpack_public_path__ + \"static/media/pobreza_cantones.1aab7407.csv\";","export default __webpack_public_path__ + \"static/media/pobreza_parroquias.1bc37f84.csv\";","import * as Papa from \"papaparse\";\r\nimport provinciaCsv from \"../data/elecciones_provincia.csv\";\r\nimport circunscripcionCsv from \"../data/elecciones_circunscripcion.csv\";\r\nimport cantonCsv from \"../data/elecciones_canton.csv\";\r\nimport parroquiaCsv from \"../data/elecciones_parroquia.csv\";\r\nimport zonaCsv from \"../data/elecciones_zona.csv\";\r\nimport juntaCsv from \"../data/elecciones_junta.csv\";\r\nimport resultadosCsv from \"../data/elecciones_res_presidente.csv\";\r\nimport pobCantonesCsv from \"../data/pobreza_cantones.csv\";\r\nimport pobParroquiasCsv from \"../data/pobreza_parroquias.csv\";\r\nimport { Table } from \"../enums\";\r\nimport alasql from \"alasql\";\r\nimport tablesSQL from \"../data/tables.sql\";\r\n\r\ninterface TableData {\r\n  table: Table;\r\n  path: string;\r\n}\r\n\r\nconst data: TableData[] = [\r\n  {\r\n    table: Table.Provincia,\r\n    path: provinciaCsv,\r\n  },\r\n  {\r\n    table: Table.Circunscripcion,\r\n    path: circunscripcionCsv,\r\n  },\r\n  {\r\n    table: Table.Canton,\r\n    path: cantonCsv,\r\n  },\r\n  {\r\n    table: Table.Parroquia,\r\n    path: parroquiaCsv,\r\n  },\r\n  {\r\n    table: Table.Zona,\r\n    path: zonaCsv,\r\n  },\r\n  {\r\n    table: Table.Junta,\r\n    path: juntaCsv,\r\n  },\r\n  {\r\n    table: Table.ResPresidente,\r\n    path: resultadosCsv,\r\n  },\r\n  {\r\n    table: Table.PobCantones,\r\n    path: pobCantonesCsv,\r\n  },\r\n  {\r\n    table: Table.PobParroquias,\r\n    path: pobParroquiasCsv,\r\n  },\r\n];\r\n\r\nasync function parseData(data: TableData): Promise<any[]> {\r\n  return new Promise((res, error) => {\r\n    Papa.parse(data.path, {\r\n      download: true,\r\n      header: true,\r\n      dynamicTyping: true,\r\n      complete: function (results) {\r\n        res(results.data);\r\n      },\r\n      error,\r\n    });\r\n  });\r\n}\r\n\r\nexport async function initDb() {\r\n  alasql(tablesSQL);\r\n\r\n  for (const table of data) {\r\n    (alasql as any).tables[table.table].data = await parseData(table);\r\n    alasql(`CREATE INDEX ${table.table}_id ON ${table.table} (id)`);\r\n    alasql(`REINDEX ${table.table}_id`);\r\n\r\n    const obj = (alasql as any).tables[table.table].data[0];\r\n    const foreignKeys = Object.keys(obj).filter((key) => key.endsWith(\"Id\"));\r\n    for (const foreignKey of foreignKeys) {\r\n      alasql(\r\n        `CREATE INDEX ${table.table}_${foreignKey} ON ${table.table} (${foreignKey})`\r\n      );\r\n      alasql(`REINDEX ${table.table}_${foreignKey}`);\r\n    }\r\n  }\r\n}\r\n","import React, { useEffect } from \"react\";\r\nimport { HeatMapType } from \"../../enums\";\r\nimport { ColorGuide } from \"../ColorGuide\";\r\nimport { Map } from \"../Map\";\r\nimport { Toolbar } from \"../Toolbar\";\r\nimport { HeatMap, PovertyHeatMap } from \"../../heatmaps\";\r\nimport { useState } from \"react\";\r\nimport { Text } from \"@chakra-ui/react\";\r\nimport { initDb } from \"../../bin\";\r\n\r\nexport interface LayoutProps {}\r\n\r\nconst Layout: React.FC<LayoutProps> = () => {\r\n  const [heatMap, setHeatMap] = useState(HeatMapType.Poverty);\r\n  const [heatMapMap, setHeatMapMap] = useState<Record<HeatMapType, HeatMap>>();\r\n\r\n  useEffect(() => {\r\n    initDb().then(() => {\r\n      const heatMapMap: Record<HeatMapType, HeatMap> = {\r\n        [HeatMapType.Poverty]: new PovertyHeatMap(),\r\n      };\r\n      setHeatMapMap(heatMapMap);\r\n    });\r\n  }, []);\r\n\r\n  return heatMapMap ? (\r\n    <>\r\n      <Toolbar heatMapType={heatMap} onHeatMapChange={setHeatMap} />\r\n      <Map heatMap={heatMapMap[heatMap]} />\r\n      <ColorGuide heatMap={heatMapMap[heatMap]} />\r\n    </>\r\n  ) : (\r\n    <Text>Cargando...</Text>\r\n  );\r\n};\r\n\r\nexport default Layout;\r\n","import { mode } from \"@chakra-ui/theme-tools\";\r\n\r\nexport const styles = {\r\n  global: (props: any) => ({\r\n    body: {\r\n      bg: mode(\"gray.100\", \"gray.800\")(props),\r\n    },\r\n  }),\r\n};\r\n","import { ChakraProvider, extendTheme } from \"@chakra-ui/react\";\r\nimport React from \"react\";\r\nimport { Layout } from \"../../components\";\r\nimport { colors, fonts, styles } from \"../../theme\";\r\n\r\nconst theme = extendTheme({ colors, fonts, styles });\r\n\r\nfunction App() {\r\n  return (\r\n    <ChakraProvider theme={theme}>\r\n      <Layout />\r\n    </ChakraProvider>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","export const colors = {\r\n  brand: {\r\n    50: \"#edfbe3\",\r\n    100: \"#d4efbf\",\r\n    200: \"#b9e39a\",\r\n    300: \"#9ed873\",\r\n    400: \"#83cc4c\",\r\n    500: \"#69b333\",\r\n    600: \"#518b26\",\r\n    700: \"#3a6319\",\r\n    800: \"#203d0c\",\r\n    900: \"#061600\",\r\n  },\r\n};\r\n","export const fonts = {\r\n  body: \"Open Sans\",\r\n  heading: \"Open Sans\",\r\n  mono: \"Menlo, monospace\",\r\n};\r\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./containers\";\nimport \"./index.css\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","module.exports = \"create table IF NOT EXISTS provincia (\\r\\n  id integer not null primary key,\\r\\n  nombre TEXT not null,\\r\\n  circunscripcion boolean not null\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS circunscripcion (\\r\\n  id integer not null primary key,\\r\\n  codigo integer not null,\\r\\n  nombre TEXT not null,\\r\\n  provinciaId integer not null,\\r\\n  FOREIGN KEY (provinciaId) REFERENCES provincia (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS canton (\\r\\n  id integer not null primary key,\\r\\n  codigo integer not null,\\r\\n  nombre TEXT not null,\\r\\n  provinciaId integer not null,\\r\\n  cirId integer,\\r\\n  FOREIGN KEY (provinciaId) REFERENCES provincia (id),\\r\\n  FOREIGN KEY (cirId) REFERENCES circunscripcion (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS parroquia (\\r\\n  id integer not null primary key,\\r\\n  codigo integer not null,\\r\\n  nombre TEXT not null,\\r\\n  cantonId integer not null,\\r\\n  FOREIGN KEY (cantonId) REFERENCES canton (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS zona (\\r\\n  id integer not null primary key,\\r\\n  codigo integer not null,\\r\\n  nombre TEXT not null,\\r\\n  parroquiaId integer not null,\\r\\n  FOREIGN KEY (parroquiaId) REFERENCES parroquia (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS junta (\\r\\n  id integer not null primary key,\\r\\n  codigo integer not null,\\r\\n  nombre TEXT not null,\\r\\n  zonaId integer not null,\\r\\n  FOREIGN KEY (zonaId) REFERENCES zona (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS res_presidente (\\r\\n  id integer not null primary key,\\r\\n  cand_1 integer not null,\\r\\n  cand_2 integer not null,\\r\\n  cand_3 integer not null,\\r\\n  cand_4 integer not null,\\r\\n  cand_5 integer not null,\\r\\n  cand_6 integer not null,\\r\\n  cand_7 integer not null,\\r\\n  cand_8 integer not null,\\r\\n  cand_9 integer not null,\\r\\n  cand_10 integer not null,\\r\\n  cand_11 integer not null,\\r\\n  cand_12 integer not null,\\r\\n  cand_13 integer not null,\\r\\n  cand_14 integer not null,\\r\\n  cand_15 integer not null,\\r\\n  cand_16 integer not null,\\r\\n  total_suf integer not null,\\r\\n  blanco integer not null,\\r\\n  nulo integer not null,\\r\\n  juntaId integer not null,\\r\\n  FOREIGN KEY (juntaId) REFERENCES junta (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS pob_cantones (\\r\\n  codigo integer not null primary key,\\r\\n  nombre TEXT not null,\\r\\n  no_pobres integer not null,\\r\\n  pobres integer not null,\\r\\n  total integer not null,\\r\\n  cantonId integer not null,\\r\\n  FOREIGN KEY (cantonId) REFERENCES canton (id)\\r\\n);\\r\\n\\r\\ncreate table IF NOT EXISTS pob_parroquias (\\r\\n  codigo integer not null primary key,\\r\\n  nombre TEXT not null,\\r\\n  no_pobres integer not null,\\r\\n  pobres integer not null,\\r\\n  total integer not null,\\r\\n  parroquiaId integer not null,\\r\\n  FOREIGN KEY (parroquiaId) REFERENCES parroquia (id)\\r\\n);\""],"sourceRoot":""}